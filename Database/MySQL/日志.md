# redo log
记录 **物理修改**
InnoDB 独有, 循环写
*“先写日志，再写数据”* 在空闲时将修改写入磁盘
- 提高数据库的事务处理性能 (避免每次提交都刷数据页)。
- 保证事务的持久性 (即使系统崩溃也能恢复已提交的事务)。
- 实现崩溃恢复 (通过 Redo Log 将数据库恢复到崩溃前的状态)。

## 抖动
- 脏页: 已经写入 redo log 但未写入磁盘数据页
- 干净页: 内存和磁盘上的数据页的内容一致

抖动原因: 从 redo log 写入数据 (flush)
- ! redo log 已满
- ! 内存不足, 需要淘汰数据页, 如果是脏页, 需要先将脏页写入磁盘
- 系统空闲
- 正常关闭

InnoDB 的刷盘速度取决于: 
- 脏页比例
- redo log 写盘速度
将`innodb_io_capacity`设置为磁盘的 IOPS, 不让脏页比例接近 $75\%$

# binlog
记录 **逻辑操作**
Server 层实现, 任何引擎都可以用
追加写

# 两阶段提交
准备 => 提交, 保证两个 log 的数据一致性
![2e5bff4910ec189fe1ee6e2ecc7b4bbe.png](https://raw.githubusercontent.com/hmmm42/Picbed/main/obsidian/pictures2e5bff4910ec189fe1ee6e2ecc7b4bbe.png)

# undo log
用于事务回滚